{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n  searchForm: document.querySelector('.search-form'),\n  wrapperPictures: document.querySelector('.pictures-list'),\n  loader: document.querySelector('.loader'),\n  loadBtn: document.querySelector('.load-btn'),\n};\n\nlet currentPage = 1;\nlet currentSearch = '';\nlet cardHeight = 0;\n\n\nrefs.loadBtn.style.display = 'none';\n\nrefs.searchForm.addEventListener('submit', onSubmitForm);\nrefs.loadBtn.addEventListener('click', onLoadMoreBtn);\n\nasync function onSubmitForm(e) {\n  e.preventDefault();\n  const symbol = e.target.elements.query.value;\n\n  if (!symbol.trim()) {\n    iziToast.warning({\n      message: 'Field can not be empty',\n      position: 'topRight',\n      backgroundColor: '#FFD700',\n      messageColor: '#000000',\n    });\n    return;\n  }\n\n  refs.loader.style.display = 'inline-block';\n\n  try {\n    currentSearch = symbol;\n    const { data } = await getPicture(currentSearch, currentPage);\n    renderPictures(data.hits);\n\n    if (data.hits.length === 0) {\n      iziToast.error({\n        message: 'Sorry, there are no images matching your search query. Please try again!',\n        position: 'topRight',\n        backgroundColor: '#EF4040',\n        messageColor: '#FAFAFB',\n      });\n    } else {\n      cardHeight = getCardHeight();\n      smoothScroll();\n      showLoadBtn();\n    }\n  } catch (error) {\n    console.error(error);\n  } finally {\n    refs.loader.style.display = 'none';\n    smoothScroll();\n  }\n\n  e.target.reset();\n}\n\nasync function onLoadMoreBtn() {\n  currentPage += 1;\n  showLoader();\n\n  try {\n    const { data } = await getPicture(currentSearch, currentPage);\n\n    if (data.hits.length === 0) {\n      showEndMessage();\n    } else {\n      appendPictures(data.hits);\n      cardHeight = getCardHeight();\n      smoothScroll();\n      showLoadBtn();\n    }\n  } catch (error) {\n    console.error(error);\n  } finally {\n    hideLoader();\n    smoothScroll();\n  }\n}\n\nfunction showLoadBtn() {\n  refs.loadBtn.style.display = 'block';\n  refs.loadBtn.style.display = 'margin 0 auto'\n}\n\nfunction showLoader() {\n  refs.loader.style.display = 'inline-block';\n}\n\nfunction hideLoader() {\n  refs.loader.style.display = 'none';\n}\n\nasync function getPicture(symbol, page) {\n  const API_KEY = '42136767-fa6744b1a2510b3114c4aacf9';\n  const BASE_URL = 'https://pixabay.com';\n  const END_POINT = '/api/';\n  const params = {\n    key: API_KEY,\n    q: symbol,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: page,\n    per_page: 40,\n  };\n  const url = `${BASE_URL}${END_POINT}?${new URLSearchParams(params)}`;\n\n  return axios.get(url);\n}\n\nfunction pictureTemplate({\n  webformatURL,\n  largeImageURL,\n  tags,\n  likes,\n  views,\n  comments,\n  downloads,\n}) {\n  return `<li class=\"gallery-card\">\n    <a class=\"gallary-card-link\" href=\"${largeImageURL}\">\n      <img src=\"${webformatURL}\" alt=\"${tags}\" />\n      <ul class=\"image-info\">\n        <li class=\"image-item-info\">\n          <p>Likes</p>\n          <p>${likes}</p>\n        </li>\n        <li class=\"image-item-info\">\n          <p>Views</p>\n          <p>${views}</p>\n        </li>\n        <li class=\"image-item-info\">\n          <p>Comments</p>\n          <p>${comments}</p>\n        </li>\n        <li class=\"image-item-info\">\n          <p>Downloads</p>\n          <p>${downloads}</p>\n        </li>\n      </ul>\n    </a>\n  </li>`;\n}\n\nfunction picturesTemplate(pictures) {\n  return pictures.map(pictureTemplate).join('');\n}\n\nfunction renderPictures(pictures) {\n  refs.wrapperPictures.innerHTML = picturesTemplate(pictures);\n  initializeLightbox();\n  smoothScroll();\n}\n\nfunction appendPictures(pictures) {\n  refs.wrapperPictures.innerHTML += picturesTemplate(pictures);\n  initializeLightbox();\n  smoothScroll();\n}\n\nfunction showEndMessage() {\n  iziToast.info({\n    title: '',\n    message: \"We're sorry, but you've reached the end of search results.\",\n    position: 'topRight',\n    backgroundColor: '#EF4040',\n    messageColor: '#ffffff',\n  });\n  hideLoadBtn();\n  smoothScroll();\n}\n\nfunction hideLoadBtn() {\n  refs.loadBtn.style.display = 'none';\n}\n\nfunction getCardHeight() {\n  const galleryItem = document.querySelector('.gallery-card');\n  const { height } = galleryItem.getBoundingClientRect();\n  return height;\n}\n\nfunction smoothScroll() {\n  const scrollHeight = currentPage * cardHeight;\n  window.scrollBy({\n    top: scrollHeight,\n    behavior: 'smooth',\n  });\n}\n\nfunction initializeLightbox() {\n  const lightbox = new SimpleLightbox('.gallery-card a.gallary-card-link', {\n    captionDelay: 250,\n    captionsData: 'alt',\n  });\n  lightbox.refresh();\n}\n"],"names":["refs","currentPage","currentSearch","cardHeight","onSubmitForm","onLoadMoreBtn","symbol","iziToast","data","getPicture","renderPictures","getCardHeight","smoothScroll","showLoadBtn","error","showLoader","showEndMessage","appendPictures","hideLoader","page","API_KEY","BASE_URL","END_POINT","params","url","axios","pictureTemplate","webformatURL","largeImageURL","tags","likes","views","comments","downloads","picturesTemplate","pictures","initializeLightbox","hideLoadBtn","galleryItem","height","scrollHeight","SimpleLightbox"],"mappings":"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"}